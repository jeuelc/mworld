<!-- i-C-a -->
<div data-role="page" id="jigsawpage">  
  <script src="js/hammer.js"></script>
  <script src="js/jquery.hammer.js"></script>
  <div data-role="content">
    <div id="wrapper">
      <div style="margin:auto; text-align:left;"><h3>Tap on a puzzle piece to rotate.</h3></div>
      <div id="zoomwrapper">
          <div id="jpiece1" class="jigsawPiece" style="left:100px;top:350px;">
             <img src="css/images/jigsaw/pieces/1.png" alt="" width="246" height="196" />
          </div>
          <div id="jpiece2"class="jigsawPiece" style="left:10px;top:550px;">
             <img src="css/images/jigsaw/pieces/2.png" alt="" width="246" height="196" />
          </div>
          <div id="jpiece3" class="jigsawPiece" style="left:20px;top:100px;">
             <img src="css/images/jigsaw/pieces/3.png" alt="" width="196" height="196" />
          </div>
          <div id="jpiece4" class="jigsawPiece" style="left:10px;top:200px;">
             <img src="css/images/jigsaw/pieces/4.png" alt="" width="245" height="244" />
          </div>
          <div id="jpiece5" class="jigsawPiece" style="left:30px;top:300px;">
             <img src="css/images/jigsaw/pieces/5.png" alt="" width="245" height="244" />
          </div>
          <div id="jpiece6" class="jigsawPiece" style="left:50px;top:100px;">
             <img src="css/images/jigsaw/pieces/6.png" alt="" width="199" height="244" />
          </div>
          <div id="jpiece7" class="jigsawPiece" style="left:50px;top:350px;">
             <img src="css/images/jigsaw/pieces/7.png" alt="" width="246" height="253" />
          </div>
          <div id="jpiece8" class="jigsawPiece" style="left:10px;top:200px;">
             <img src="css/images/jigsaw/pieces/8.png" alt="" width="246" height="249" />
          </div>
          <div id="jpiece9" class="jigsawPiece" style="left:20px;top:500px;">
             <img src="css/images/jigsaw/pieces/9.png" alt="" width="198" height="249" />
          </div>
      </div><!--/zoomwrapper-->
    </div>
    <div class="v-spacer"></div>
    
  </div> <!-- end content -->  
   <script>
    $(function() {
      //alert("doc ready");
      $("div#jpiece7 > img").css("-webkit-transform", "rotate(90deg)");
      $("div#jpiece5 > img").css("-webkit-transform", "rotate(270deg)");
      $("div#jpiece3 > img").css("-webkit-transform", "rotate(180deg)");
      $("div#jpiece1 > img").css("-webkit-transform", "rotate(90deg)");
    });
   
    $('.jigsawPiece').on('tap', function() {
      var curAngle = getRotationDegrees($("div#"+this.id+" > img"));
      if(curAngle < 270) { curAngle = curAngle + 90; 
      } else { curAngle = 0; }
      
      $("div#"+this.id+" > img").css("-webkit-transform", "rotate("+curAngle+"deg)");
      //$("div#"+this.id+" > img").css("-moz-transform", "rotate("+curAngle+"deg)");
      //$("div#"+this.id+" > img").css("-ms-transform", "rotate("+curAngle+"deg)");
      //$("div#"+this.id+" > img").css("-o-transform", "rotate("+curAngle+"deg)");
      //$("div#"+this.id+" > img").css("transform", "rotate("+curAngle+"deg)");
      
    }); 
    
    function getRotationDegrees(obj) {
      var matrix = obj.css("-webkit-transform") ||
      obj.css("-moz-transform")    ||
      obj.css("-ms-transform")     ||
      obj.css("-o-transform")      ||
      obj.css("transform");
      if(matrix !== 'none') {
          var values = matrix.split('(')[1].split(')')[0].split(',');
          var a = values[0];
          var b = values[1];
          var angle = Math.round(Math.atan2(b, a) * (180/Math.PI));
      } else { var angle = 0; }
      return angle;
    }
    
    
   </script>
   <script src="js/jigsawLogic.js"></script>
</div>